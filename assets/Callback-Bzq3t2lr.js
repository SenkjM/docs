import{B}from"./Button-Dff9sXF-.js";import{d as S,r as I,b as a,u as t,o as n,e as i,h as l,t as u,i as s,g as p,f as V,N as C,a0 as z}from"./app-Dr385GFQ.js";import{N as m}from"./Alert-C2hF9rwd.js";import{N as A}from"./Input-B0IhrA8Q.js";import{_ as D}from"./plugin-vue_export-helper-DlAUqK2U.js";const L=S({__name:"Callback",setup(R){const c=new URL(window.location.href),d=c.searchParams.get("code"),x=c.searchParams.get("state"),_=c.searchParams.get("error"),P=c.searchParams.get("error_description"),[f,k,y]=atob(x).split("::"),r=I();d&&!_&&(async()=>{const o=new URLSearchParams;o.append("client_id",f),o.append("client_secret",k),o.append("code",d),o.append("grant_type","authorization_code"),o.append("redirect_uri",y),fetch("https://www.googleapis.com/oauth2/v4/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o}).then(e=>e.json()).then(e=>{console.log(e),r.value=e})})();function T(){var o;window.open(`/tool/google/album?access_token=${(o=r.value)==null?void 0:o.access_token}`,"_blank")}return(o,e)=>!t(d)||t(_)?(n(),a(t(m),{key:0,title:t(_)||"Error",type:"error"},{default:i(()=>[l(u(t(P)),1)]),_:1},8,["title"])):(n(),a(t(C),{key:1,vertical:"",size:"large"},{default:i(()=>{var g,v,b;return[s("p",null,[e[0]||(e[0]=s("b",null,"client_id: ",-1)),l(u(t(f)),1)]),s("p",null,[e[1]||(e[1]=s("b",null,"client_secret: ",-1)),l(u(t(k)),1)]),s("p",null,[e[2]||(e[2]=s("b",null,"redirect_uri: ",-1)),l(u(t(y)),1)]),(g=r.value)!=null&&g.error||(v=r.value)!=null&&v.error_description?(n(),a(t(m),{key:0,title:(b=r.value)==null?void 0:b.error,type:"error"},{default:i(()=>[l(u(r.value.error_description),1)]),_:1},8,["title"])):p("",!0),V(t(C),{vertical:""},{default:i(()=>{var w,N,h;return[e[5]||(e[5]=s("b",null,"refresh_token:",-1)),r.value?p("",!0):(n(),a(t(z),{key:0})),(w=r.value)!=null&&w.refresh_token?(n(),a(t(A),{key:1,type:"textarea",autosize:"",readonly:"",value:r.value.refresh_token},null,8,["value"])):(N=r.value)!=null&&N.access_token?(n(),a(t(m),{key:2,title:"Web client",type:"warning"},{default:i(()=>e[3]||(e[3]=[l(" The refresh_token is only returned once if you use a web client. ")])),_:1,__:[3]})):p("",!0),(h=r.value)!=null&&h.access_token?(n(),a(t(B),{key:3,onClick:T,block:"",type:"primary"},{default:i(()=>e[4]||(e[4]=[l("Get Album ID")])),_:1,__:[4]})):p("",!0)]}),_:1,__:[5]})]}),_:1}))}}),$=D(L,[["__scopeId","data-v-18105aea"]]);export{$ as C};
